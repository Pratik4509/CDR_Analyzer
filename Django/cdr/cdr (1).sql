-- phpMyAdmin SQL Dump
-- version 5.0.4
-- https://www.phpmyadmin.net/
--
-- Host: 127.0.0.1
-- Generation Time: Mar 17, 2021 at 09:24 AM
-- Server version: 10.4.17-MariaDB
-- PHP Version: 8.0.0

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Database: `cdr`
--

-- --------------------------------------------------------

--
-- Table structure for table `cdr_logs`
--

CREATE TABLE `cdr_logs` (
  `CallingNo` bigint(10) NOT NULL,
  `CalledNo` bigint(10) NOT NULL,
  `CallType` text NOT NULL,
  `CallDate` date NOT NULL,
  `CallTime` time NOT NULL,
  `CallDuration` int(5) NOT NULL,
  `FirstCellId` varchar(20) NOT NULL,
  `LastCellId` varchar(20) NOT NULL,
  `IMEINo` bigint(20) NOT NULL,
  `Circle` text NOT NULL,
  `id` int(30) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Dumping data for table `cdr_logs`
--

INSERT INTO `cdr_logs` (`CallingNo`, `CalledNo`, `CallType`, `CallDate`, `CallTime`, `CallDuration`, `FirstCellId`, `LastCellId`, `IMEINo`, `Circle`, `id`) VALUES
(9374498977, 9934498226, 'out', '2020-11-01', '16:25:13', 119, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 1),
(9934498226, 9374498977, 'in', '2020-11-01', '03:29:57', 10, '404-60-9850-45772', '404-60-9850-45773', 100000000000001, 'Maharashtra-Goa', 2),
(9374498977, 8002887953, 'out', '2020-11-01', '19:50:50', 54, '404-60-9850-45773', '404-60-9850-45773', 100000000000001, 'Maharashtra-Goa', 3),
(9374498977, 7739663559, 'out', '2020-11-01', '05:21:18', 54, '404-60-9850-45773', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 4),
(9934498226, 9374498977, 'in', '2020-11-02', '15:24:47', 89, '404-60-9850-45773', '404-60-9850-45773', 100000000000001, 'Maharashtra-Goa', 5),
(9218497283, 9374498977, 'in', '2020-11-02', '15:30:13', 33, '404-60-9850-45776', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 6),
(9934498226, 9374498977, 'in', '2020-11-03', '07:51:17', 25, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 7),
(9934498226, 9374498977, 'in', '2020-11-03', '23:57:39', 90, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 8),
(9374498977, 8002887953, 'out', '2020-11-03', '00:48:04', 66, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 9),
(9374498977, 7739663559, 'out', '2020-11-03', '03:50:41', 67, '404-60-9850-45776', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 10),
(9374498977, 9934498226, 'out', '2020-11-04', '02:33:40', 45, '404-60-9850-45775', '404-60-9850-45775', 100000000000001, 'Maharashtra-Goa', 11),
(9934498226, 9374498977, 'in', '2020-11-04', '15:25:08', 53, '404-60-9850-45776', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 12),
(9374498977, 8002887953, 'out', '2020-11-04', '20:26:40', 88, '404-60-9850-45774', '404-60-9850-45774', 100000000000001, 'Maharashtra-Goa', 13),
(8002887953, 9374498977, 'in', '2020-11-04', '15:14:41', 222, '404-60-9850-45773', '404-60-9850-45773', 100000000000001, 'Maharashtra-Goa', 14),
(9374498977, 9218497283, 'out', '2020-11-04', '07:40:40', 65, '404-60-9850-45776', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 15),
(9374498977, 7739663559, 'out', '2020-11-04', '04:02:49', 54, '404-60-9850-45775', '404-60-9850-45775', 100000000000001, 'Maharashtra-Goa', 16),
(9934498226, 9374498977, 'in', '2020-11-05', '11:25:58', 4, '404-60-9850-45776', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 17),
(9374498977, 7739663559, 'out', '2020-11-05', '21:03:59', 54, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 18),
(7739663559, 9374498977, 'in', '2020-11-05', '21:33:37', 65, '404-60-9850-45776', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 19),
(9934498226, 9374498977, 'in', '2020-11-06', '23:22:25', 77, '404-60-9850-45773', '404-60-9850-45773', 100000000000001, 'Maharashtra-Goa', 20),
(9934498226, 9374498977, 'in', '2020-11-06', '06:47:51', 200, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 21),
(8757170654, 9374498977, 'in', '2020-11-06', '01:46:58', 14, '404-60-9850-45775', '404-60-9850-45775', 100000000000001, 'Maharashtra-Goa', 22),
(9218497283, 9374498977, 'in', '2020-11-06', '09:02:11', 789, '404-60-9850-45774', '404-60-9850-45774', 100000000000001, 'Maharashtra-Goa', 23),
(9934498226, 9374498977, 'in', '2020-11-07', '12:55:42', 539, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 24),
(9934498226, 9374498977, 'in', '2020-11-07', '15:00:58', 73, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 25),
(7739663559, 9374498977, 'in', '2020-11-07', '22:51:07', 77, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 26),
(9934498226, 9374498977, 'in', '2020-11-08', '03:19:34', 1112, '404-60-9850-45775', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 27),
(9934498226, 9374498977, 'in', '2020-11-09', '02:07:20', 42, '404-60-9850-45776', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 28),
(9374498977, 8002887953, 'out', '2020-11-09', '09:52:53', 987, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 29),
(8002887953, 9374498977, 'in', '2020-11-09', '06:01:46', 879, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 30),
(9374498977, 8757170654, 'out', '2020-11-09', '12:01:17', 87, '404-60-9850-45772', '404-60-9850-45773', 100000000000001, 'Maharashtra-Goa', 31),
(9934498226, 9374498977, 'in', '2020-11-10', '06:58:31', 42, '404-60-9850-45773', '404-60-9850-45773', 100000000000001, 'Maharashtra-Goa', 32),
(8002887953, 9374498977, 'in', '2020-11-10', '21:14:47', 55, '404-60-9850-45772', '404-60-9850-45775', 100000000000001, 'Maharashtra-Goa', 33),
(9374498977, 8757170654, 'out', '2020-11-11', '10:24:31', 998, '404-60-9850-45773', '404-60-9850-45773', 100000000000001, 'Maharashtra-Goa', 34),
(8757170654, 9374498977, 'in', '2020-11-11', '06:17:28', 89, '404-60-9850-45773', '404-60-9850-45773', 100000000000001, 'Maharashtra-Goa', 35),
(9374498977, 7739663559, 'out', '2020-11-11', '08:53:31', 34, '404-60-9850-45776', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 36),
(7739663559, 9374498977, 'in', '2020-11-11', '23:19:16', 99, '404-60-9850-45775', '404-60-9850-45773', 100000000000001, 'Maharashtra-Goa', 37),
(7739663559, 9374498977, 'in', '2020-11-11', '17:09:43', 65, '404-60-9850-45773', '404-60-9850-45773', 100000000000001, 'Maharashtra-Goa', 38),
(9934498226, 9374498977, 'in', '2020-11-12', '08:48:32', 14, '404-60-9850-45775', '404-60-9850-45775', 100000000000001, 'Maharashtra-Goa', 39),
(9218497283, 9374498977, 'in', '2020-11-12', '00:13:02', 546, '404-60-9850-45776', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 40),
(9934498226, 9374498977, 'in', '2020-11-13', '21:26:34', 96, '404-60-9850-45773', '404-60-9850-45773', 100000000000001, 'Maharashtra-Goa', 41),
(9374498977, 9218497283, 'out', '2020-11-13', '22:45:39', 666, '404-60-9850-45773', '404-60-9850-45773', 100000000000001, 'Maharashtra-Goa', 42),
(9374498977, 7739663559, 'out', '2020-11-13', '01:56:14', 66, '404-60-9850-45773', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 43),
(9374498977, 9934498226, 'out', '2020-11-14', '06:29:27', 1304, '404-60-9850-45773', '404-60-9850-45773', 100000000000001, 'Maharashtra-Goa', 44),
(8757170654, 9374498977, 'in', '2020-11-14', '05:32:47', 65, '404-60-9850-45776', '404-60-9850-45775', 100000000000001, 'Maharashtra-Goa', 45),
(7739663559, 9374498977, 'in', '2020-11-14', '00:32:22', 33, '404-60-9850-45776', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 46),
(9934498226, 9374498977, 'in', '2020-11-15', '08:33:58', 765, '404-60-9850-45775', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 47),
(9934498226, 9374498977, 'in', '2020-11-16', '02:31:05', 86, '404-60-9850-45776', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 48),
(9374498977, 9934498226, 'out', '2020-11-17', '13:51:50', 1321, '404-60-9850-45776', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 49),
(9934498226, 9374498977, 'in', '2020-11-17', '23:45:39', 15, '404-60-9850-45775', '404-60-9850-45775', 100000000000001, 'Maharashtra-Goa', 50),
(9934498226, 9374498977, 'in', '2020-11-17', '00:42:52', 21, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 51),
(9374498977, 8002887953, 'out', '2020-11-17', '13:33:08', 123, '404-60-9850-45774', '404-60-9850-45774', 100000000000001, 'Maharashtra-Goa', 52),
(9374498977, 8002887953, 'out', '2020-11-17', '14:00:10', 344, '404-60-9850-45773', '404-60-9850-45773', 100000000000001, 'Maharashtra-Goa', 53),
(8002887953, 9374498977, 'in', '2020-11-17', '12:51:36', 44, '404-60-9850-45775', '404-60-9850-45775', 100000000000001, 'Maharashtra-Goa', 54),
(8757170654, 9374498977, 'in', '2020-11-17', '10:58:58', 78, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 55),
(9218497283, 9374498977, 'in', '2020-11-17', '08:02:04', 77, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 56),
(9218497283, 9374498977, 'in', '2020-11-17', '21:00:28', 65, '404-60-9850-45776', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 57),
(9934498226, 9374498977, 'in', '2020-11-18', '03:34:49', 33, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 58),
(8002887953, 9374498977, 'in', '2020-11-18', '09:03:55', 22, '404-60-9850-45774', '404-60-9850-45774', 100000000000001, 'Maharashtra-Goa', 59),
(7739663559, 9374498977, 'in', '2020-11-18', '06:05:32', 44, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 60),
(9374498977, 9934498226, 'out', '2020-11-19', '11:39:18', 9, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 61),
(9374498977, 9934498226, 'out', '2020-11-19', '02:23:44', 65, '404-60-9850-45772', '404-60-9850-45775', 100000000000001, 'Maharashtra-Goa', 62),
(9934498226, 9374498977, 'in', '2020-11-19', '22:18:11', 432, '404-60-9850-45775', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 63),
(9374498977, 9218497283, 'out', '2020-11-19', '00:16:11', 778, '404-60-9850-45775', '404-60-9850-45774', 100000000000001, 'Maharashtra-Goa', 64),
(9374498977, 9218497283, 'out', '2020-11-19', '14:19:27', 987, '404-60-9850-45774', '404-60-9850-45774', 100000000000001, 'Maharashtra-Goa', 65),
(7739663559, 9374498977, 'in', '2020-11-19', '21:53:51', 57, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 66),
(9934498226, 9374498977, 'in', '2020-11-20', '04:03:06', 12, '404-60-9850-45776', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 67),
(9374498977, 8757170654, 'out', '2020-11-20', '16:34:18', 456, '404-60-9850-45775', '404-60-9850-45775', 100000000000001, 'Maharashtra-Goa', 68),
(8757170654, 9374498977, 'in', '2020-11-20', '01:52:56', 66, '404-60-9850-45776', '404-60-9850-45775', 100000000000001, 'Maharashtra-Goa', 69),
(9374498977, 7739663559, 'out', '2020-11-20', '09:17:18', 88, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 70),
(9374498977, 7739663559, 'out', '2020-11-20', '17:39:39', 97, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 71),
(9374498977, 9218497283, 'out', '2020-11-21', '03:48:51', 546, '404-60-9850-45774', '404-60-9850-45774', 100000000000001, 'Maharashtra-Goa', 72),
(9374498977, 9218497283, 'out', '2020-11-23', '12:19:47', 345, '404-60-9850-45772', '404-60-9850-45772', 100000000000001, 'Maharashtra-Goa', 73),
(9374498977, 9218497283, 'out', '2020-11-25', '14:36:23', 65, '404-60-9850-45776', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 74),
(9218497283, 9374498977, 'in', '2020-11-25', '00:14:41', 98, '404-60-9850-45773', '404-60-9850-45773', 100000000000001, 'Maharashtra-Goa', 75),
(9374498977, 7739663559, 'out', '2020-11-25', '23:26:00', 67, '404-60-9850-45775', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 76),
(9934498226, 9374498977, 'in', '2020-11-26', '04:52:07', 37, '404-60-9850-45776', '404-60-9850-45776', 100000000000001, 'Maharashtra-Goa', 77),
(9934498226, 9374498977, 'in', '2020-11-26', '04:05:33', 13, '404-60-9850-45775', '404-60-9850-45775', 100000000000001, 'Maharashtra-Goa', 78),
(9934498226, 9374498977, 'in', '2020-11-26', '05:04:55', 1379, '404-60-9850-45775', '404-60-9850-45773', 100000000000001, 'Maharashtra-Goa', 79),
(9934498226, 9374498977, 'in', '2020-11-26', '22:52:52', 8, '404-60-9850-45773', '404-60-9850-45773', 100000000000001, 'Maharashtra-Goa', 80),
(9934498226, 9374498977, 'in', '2020-11-26', '01:03:04', 24, '404-60-9850-45775', '404-60-9850-45775', 100000000000001, 'Maharashtra-Goa', 81),
(9218497283, 9374498977, 'in', '2020-11-26', '13:53:27', 34, '404-60-9850-45776', '404-60-9850-45776', 100000000000002, 'Maharashtra-Goa', 82),
(9374498977, 7739663559, 'out', '2020-11-26', '09:55:08', 878, '404-60-9850-45774', '404-60-9850-45774', 100000000000002, 'Maharashtra-Goa', 83),
(8757170654, 9374498977, 'in', '2020-11-27', '07:25:16', 45, '404-60-9850-45774', '404-60-9850-45774', 100000000000002, 'Maharashtra-Goa', 84),
(7739663559, 9374498977, 'in', '2020-11-27', '09:03:20', 78, '404-60-9850-45776', '404-60-9850-45776', 100000000000002, 'Maharashtra-Goa', 85),
(9374498977, 9934498226, 'out', '2020-11-28', '11:03:07', 111, '404-60-9850-45775', '404-60-9850-45775', 100000000000002, 'Maharashtra-Goa', 86),
(9374498977, 9934498226, 'out', '2020-11-28', '17:12:40', 791, '404-60-9850-45772', '404-60-9850-45772', 100000000000002, 'Maharashtra-Goa', 87),
(9374498977, 9934498226, 'out', '2020-11-28', '22:58:22', 29, '404-60-9850-45772', '404-60-9850-45772', 100000000000002, 'Maharashtra-Goa', 88),
(9934498226, 9374498977, 'in', '2020-11-28', '20:47:27', 51, '404-60-9850-45775', '404-60-9850-45775', 100000000000002, 'Maharashtra-Goa', 89),
(9374498977, 8757170654, 'out', '2020-11-28', '15:54:09', 543, '404-60-9850-45775', '404-60-9850-45775', 100000000000002, 'Maharashtra-Goa', 90),
(9218497283, 9374498977, 'in', '2020-11-28', '14:00:54', 13, '404-60-9850-45773', '404-60-9850-45773', 100000000000002, 'Maharashtra-Goa', 91),
(9374498977, 7739663559, 'out', '2020-11-28', '16:53:31', 456, '404-60-9850-45774', '404-60-9850-45774', 100000000000002, 'Maharashtra-Goa', 92),
(9934498226, 9374498977, 'in', '2020-11-29', '17:01:29', 10, '404-60-9850-45775', '404-60-9850-45775', 100000000000002, 'Maharashtra-Goa', 93),
(7739663559, 9374498977, 'in', '2020-11-29', '21:50:18', 66, '404-60-9850-45774', '404-60-9850-45774', 100000000000002, 'Maharashtra-Goa', 94),
(9934498226, 9374498977, 'in', '2020-11-30', '21:26:08', 72, '404-60-9850-45773', '404-60-9850-45773', 100000000000002, 'Maharashtra-Goa', 95),
(9934498226, 9374498977, 'in', '2020-11-30', '19:15:35', 50, '404-60-9850-45775', '404-60-9850-45775', 100000000000002, 'Maharashtra-Goa', 96),
(9374498977, 9218497283, 'out', '2020-11-30', '02:17:08', 77, '404-60-9850-45773', '404-60-9850-45773', 100000000000002, 'Maharashtra-Goa', 97),
(9374498977, 9218497283, 'out', '2020-12-30', '08:52:39', 55, '404-60-9850-45772', '404-60-9850-45776', 100000000000002, 'Maharashtra-Goa', 98),
(9374498977, 9934498226, 'out', '2021-11-01', '05:14:30', 69, '404-60-9850-45772', '404-60-9850-45772', 100000000000002, 'Maharashtra-Goa', 99);

-- --------------------------------------------------------

--
-- Table structure for table `cellid`
--

CREATE TABLE `cellid` (
  `Cell_ID` varchar(20) NOT NULL,
  `Address` text NOT NULL,
  `Latitude` varchar(30) NOT NULL,
  `Longitude` varchar(30) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Dumping data for table `cellid`
--

INSERT INTO `cellid` (`Cell_ID`, `Address`, `Latitude`, `Longitude`) VALUES
('404-60-9850-45772', 'A', '17.6805°N', '74.0183° E'),
('404-60-9850-45773', 'B', '17.6810° N', '74.0768° E'),
('404-60-9850-45774', 'C', '17.6840° N', '73.9885° E'),
('404-60-9850-45775', 'D', '17.7723° N', '73.9905° E'),
('404-60-9850-45776', 'E', '17.7903° N', '74.0080° E');

-- --------------------------------------------------------

--
-- Stand-in structure for view `cellidd`
-- (See below for the actual view)
--
CREATE TABLE `cellidd` (
`CellId` varchar(20)
,`Duration` decimal(32,0)
,`No_of_Calls` bigint(21)
,`Address` text
,`Latitude` varchar(30)
,`Longitude` varchar(30)
);

-- --------------------------------------------------------

--
-- Stand-in structure for view `maxduration`
-- (See below for the actual view)
--
CREATE TABLE `maxduration` (
`CalledNo` bigint(20)
,`Total_Duration` decimal(54,0)
,`total` decimal(42,0)
);

-- --------------------------------------------------------

--
-- Stand-in structure for view `maximei`
-- (See below for the actual view)
--
CREATE TABLE `maximei` (
`IMEINo` bigint(20)
,`No_of_Calls` bigint(21)
,`Total_Duration` decimal(32,0)
,`First_Call` date
,`Last_Call` date
,`Total` bigint(21)
);

-- --------------------------------------------------------

--
-- Stand-in structure for view `max_caller`
-- (See below for the actual view)
--
CREATE TABLE `max_caller` (
`CalledNo` bigint(20)
,`Total_Duration` decimal(54,0)
,`total` decimal(42,0)
);

-- --------------------------------------------------------

--
-- Stand-in structure for view `test`
-- (See below for the actual view)
--
CREATE TABLE `test` (
`CalledNo` bigint(20)
,`xyz` bigint(21)
,`Durration` decimal(32,0)
);

-- --------------------------------------------------------

--
-- Structure for view `cellidd`
--
DROP TABLE IF EXISTS `cellidd`;

CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `cellidd`  AS  (select distinct `cdr_logs`.`FirstCellId` AS `CellId`,sum(`cdr_logs`.`CallDuration`) over ( partition by `cdr_logs`.`FirstCellId`) AS `Duration`,count(`cdr_logs`.`FirstCellId`) over ( partition by `cdr_logs`.`FirstCellId`) AS `No_of_Calls`,`cellid`.`Address` AS `Address`,`cellid`.`Latitude` AS `Latitude`,`cellid`.`Longitude` AS `Longitude` from (`cdr_logs` left join `cellid` on(`cdr_logs`.`FirstCellId` = `cellid`.`Cell_ID`)) order by sum(`cdr_logs`.`CallDuration`) over ( partition by `cdr_logs`.`FirstCellId`) desc) ;

-- --------------------------------------------------------

--
-- Structure for view `maxduration`
--
DROP TABLE IF EXISTS `maxduration`;

CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `maxduration`  AS  (select distinct `test`.`CalledNo` AS `CalledNo`,sum(`test`.`Durration`) over ( partition by `test`.`CalledNo`) AS `Total_Duration`,sum(`test`.`xyz`) over ( partition by `test`.`CalledNo`) AS `total` from `test` order by `test`.`CalledNo`) ;

-- --------------------------------------------------------

--
-- Structure for view `maximei`
--
DROP TABLE IF EXISTS `maximei`;

CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `maximei`  AS  (select `cdr_logs`.`IMEINo` AS `IMEINo`,count(`cdr_logs`.`IMEINo`) AS `No_of_Calls`,sum(`cdr_logs`.`CallDuration`) AS `Total_Duration`,min(`cdr_logs`.`CallDate`) AS `First_Call`,max(`cdr_logs`.`CallDate`) AS `Last_Call`,count(distinct `cdr_logs`.`FirstCellId`) AS `Total` from `cdr_logs` group by `cdr_logs`.`IMEINo` order by `cdr_logs`.`CallDate`) ;

-- --------------------------------------------------------

--
-- Structure for view `max_caller`
--
DROP TABLE IF EXISTS `max_caller`;

CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `max_caller`  AS SELECT DISTINCT `test`.`CalledNo` AS `CalledNo`, sum(`test`.`Durration`)  ( partition by `test`.`CalledNo`) AS `over` FROM `test` ORDER BY `test`.`CalledNo` ASC ;

-- --------------------------------------------------------

--
-- Structure for view `test`
--
DROP TABLE IF EXISTS `test`;

CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `test`  AS SELECT `cdr_logs`.`CalledNo` AS `CalledNo`, count(0) AS `xyz`, sum(`cdr_logs`.`CallDuration`) AS `Durration` FROM `cdr_logs` GROUP BY `cdr_logs`.`CalledNo` ;

--
-- Indexes for dumped tables
--

--
-- Indexes for table `cdr_logs`
--
ALTER TABLE `cdr_logs`
  ADD PRIMARY KEY (`id`),
  ADD KEY `FirstCellId` (`FirstCellId`),
  ADD KEY `LastCellId` (`LastCellId`);

--
-- Indexes for table `cellid`
--
ALTER TABLE `cellid`
  ADD PRIMARY KEY (`Cell_ID`);

--
-- AUTO_INCREMENT for dumped tables
--

--
-- AUTO_INCREMENT for table `cdr_logs`
--
ALTER TABLE `cdr_logs`
  MODIFY `id` int(30) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=100;

--
-- Constraints for dumped tables
--

--
-- Constraints for table `cdr_logs`
--
ALTER TABLE `cdr_logs`
  ADD CONSTRAINT `cdr_logs_ibfk_1` FOREIGN KEY (`FirstCellId`) REFERENCES `cellid` (`Cell_ID`),
  ADD CONSTRAINT `cdr_logs_ibfk_2` FOREIGN KEY (`LastCellId`) REFERENCES `cellid` (`Cell_ID`);
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
